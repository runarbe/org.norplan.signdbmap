/*! signdbmap - v0.0.1 - 2016-02-09
* Copyright (c) 2016 ; Licensed  */
"use strict";var signDbMap=function(){function a(a,b){b.on("click",function(b){console.log("Clicked :"+a.properties.NAME_EN+"("+a.properties.ABBREV+")")})}var b={};b.Point=function(a,b,c){this.x=a,this.y=b,this.popUpMsg=null,void 0!==c&&(this.popUpMsg=c)},b.District=function(a,b,c,d){void 0===a&&(a=-1),void 0===b&&(b="n/a"),void 0===c&&(c="District name"),void 0===d&&(d="District name Arabic"),this.id=a,this.abbreviation=b,this.nameLatin=c,this.nameArabic=d},b.Street=function(){this.id=-1,this.nameLatin="Latin street name",this.nameArabic="Arabic street name"},b.Layers={MapEnglish:L.tileLayer("http://geoportal.abudhabi.ae/rest/services/BaseMapEnglish/MapServer/tile/{z}/{y}/{x}",{attribution:"Map data &copy; Abu Dhabi Municipality / Abu Dhabi SDI",maxZoom:12,minZoom:0,continuousWorld:!0}),MapArabic:L.tileLayer("http://geoportal.abudhabi.ae/rest/services/BaseMapArabic/MapServer/tile/{z}/{y}/{x}",{attribution:"Map data &copy; Abu Dhabi Municipality / Abu Dhabi SDI",maxZoom:12,minZoom:0,continuousWorld:!0}),Satellite50cm:L.tileLayer("http://geoportal.abudhabi.ae/rest/services/BaseMapSatellite50cm/MapServer/tile/{z}/{y}/{x}",{attribution:"Map data &copy; Abu Dhabi Municipality / AD-SDI",maxZoom:12,minZoom:0,continuousWorld:!0})};var c=[];b.crs=new L.Proj.CRS("EPSG:4326","+proj=longlat +datum=WGS84 +no_defs",{origin:[-400,400],resolutions:[.011897305029151402,.005948652514575701,.0029743262572878505,.00118973050291514,.00059486525145757,.00035691915087454206,.00017845957543727103,.00011897305029151401,59486525145757005e-21,35691915087454204e-21,1903568804664224e-20,951784402332112e-20,475892201166056e-20]}),b.map=null,b.init=function(a,c,d,e,f){if(b.map=L.map(a,{dragging:!0,zoomControl:!0,attributionControl:!1,crs:b.crs}),void 0===e&&(e=5),b.map.addLayer(b.Layers.Satellite50cm),b.map.addControl(new L.Control.Layers({"English base map":b.Layers.MapEnglish,"Arabic base map":b.Layers.MapArabic,"Satellite image":b.Layers.Satellite50cm},{},{collapsed:!0,position:"topright"})),f===!0){var g=new signDbMap.Point(c,d);b.addMarkers([g])}b.map.setView(new L.LatLng(d,c),e)},b.round=function(a,b){void 0===b&&(b=6);for(var c=1,d=0;b>d;d++)c=10*c;return Math.round(a*c,b)/c},b.center=function(a,c){d()&&b.map.panTo(new L.latlng(c,a))},b.getDistrictByXY=function(a,b){return new signDbMap.District},b.getStreetByXY=function(a,b){return new signDbMap.Street},b.onClick=function(a){d()&&b.map.on("click",function(b){a(b.latlng.lng,b.latlng.lat)})};var d=function(){return null===b.map?(console.debug("Map is not initialized"),!1):!0};return b.addMarkers=function(a){if(d()){for(var e=0;e<c.length;e++)b.map.removeLayer(c[e]);for(e=0;e<a.length;e++)c.push(L.marker(new L.LatLng(a[e].y,a[e].x,0)).addTo(b.map))}},b.addDistricts=function(c){console.log("Called addDistricts function"),jQuery.getJSON(c,{},function(c,e){if(d()){console.log("Loaded json"+JSON.stringify(c));L.geoJson(c,{style:{color:"black",opacity:.25},onEachFeature:a}).addTo(b.map)}else console.log("Map is not initialized")}).fail(function(a,b,c){console.log("Request failed:"+b+" - "+c)})},b}();